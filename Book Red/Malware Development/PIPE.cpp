#include <iostream>
#include <windows.h>
 
int main(int argc, char* argv[]){
    HANDLE hPipe;
    DWORD dwBytesWritten;
    const char* message = "http://maliciousDomain.com";
    DWORD messageSize = strlen(message) + 1;
 
    // Create the pipe
    hPipe = CreateNamedPipe(
        "\\\\.\\pipe\\myPipe",
        PIPE_ACCESS_OUTBOUND,
        PIPE_TYPE_BYTE,
        10,  // Max number of instances
        0,  
        0, 
        0,  
        NULL  
    );
 
    if (hPipe == INVALID_HANDLE_VALUE) {
        std::cerr << "Error creating the pipe" << std::endl;
        return 1;
    }
 
    // Connect to the pipe
    if (ConnectNamedPipe(hPipe, NULL) == FALSE) {
        std::cerr << "Error connecting to the pipe" << std::endl;
        CloseHandle(hPipe);
        return 1;
    }
 
    // Write to the pipe
    if (WriteFile(hPipe, message, messageSize, &dwBytesWritten, NULL) == FALSE) {
        std::cerr << "Error writing to the pipe" << std::endl;
        CloseHandle(hPipe);
        return 1;
    }
    FlushFileBuffers(hPipe);
    DisconnectNamedPipe(hPipe);
    CloseHandle(hPipe);
    std::getchar();
 
    return 0;
}

