#include <iostream>
#include <windows.h>
 
int main(int argc, char* argv[]){
    HANDLE hPipe;
    DWORD dwBytesRead;
    const DWORD bufferSize = 256;
    char buffer[bufferSize];
 
    // Connect to the pipe
    hPipe = CreateFile(
        "\\\\.\\pipe\\myPipe",
        GENERIC_READ,
        0,
        NULL,
        OPEN_EXISTING,
        0,
        NULL
    );
 
    if (hPipe == INVALID_HANDLE_VALUE) {
        std::cerr << "Error trying to connect to the pipe" << std::endl;
        return 1;
    }
 
    // Read from the pipe
    if (ReadFile(hPipe, buffer, bufferSize - 1, &dwBytesRead, NULL) == FALSE) {
        std::cerr << "Error reading from pipe" << std::endl;
        CloseHandle(hPipe);
        return 1;
    }
 
    // Add null character to the end of the string read
    buffer[dwBytesRead] = '\0';
    std::cout << "Malicious Domain: " << buffer << std::endl;
    CloseHandle(hPipe);
    std::getchar();
 
    return 0;
}